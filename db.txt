USE bookstore;

CREATE TABLE genres(
	id INT PRIMARY KEY AUTO_INCREMENT,
    genre VARCHAR(155)
);

CREATE TABLE authors(
	id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(155)
);

CREATE TABLE books(
	id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(155),
    author INT,
    genre INT,
    language VARCHAR(3),
    FOREIGN KEY (genre) REFERENCES genres(id) ON DELETE CASCADE,
    FOREIGN KEY (author) REFERENCES authors(id) ON DELETE CASCADE
);

CREATE TABLE users(
	id INT PRIMARY KEY AUTO_INCREMENT,
    username VARCHAR(155),
    email VARCHAR(155),
    password VARCHAR (155),
    zip_code INT,
    city VARCHAR(155),
    address VARCHAR(155)
);

CREATE TABLE reviews(
	id INT PRIMARY KEY AUTO_INCREMENT,
    book_id INT,
    user_id INT,
    title VARCHAR(70),
    content VARCHAR(500),
    published DATE,
    FOREIGN KEY (book_id) REFERENCES books(id) ON DELETE CASCADE,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
);

ALTER TABLE genres ADD COLUMN created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE authors ADD COLUMN created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE books ADD COLUMN created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE users ADD COLUMN created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
ALTER TABLE reviews ADD COLUMN created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;

